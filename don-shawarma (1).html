<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Don Shawarma - Pedidos Online</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }
        .bg-pattern {
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }
        
        /* Estilos para scroll horizontal */
        .overflow-x-auto {
            scroll-behavior: smooth;
        }
        
        .overflow-x-auto::-webkit-scrollbar {
            height: 8px;
        }
        
        .overflow-x-auto::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 4px;
        }
        
        .overflow-x-auto::-webkit-scrollbar-thumb {
            background: #fb923c;
            border-radius: 4px;
        }
        
        .overflow-x-auto::-webkit-scrollbar-thumb:hover {
            background: #f97316;
        }
        
        /* L√≠nea de indicador para scroll horizontal */
        .overflow-x-auto {
            position: relative;
        }
        
        .line-clamp-3 {
            display: -webkit-box;
            -webkit-line-clamp: 3;
            line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-orange-50 to-yellow-50">

    <!-- Header/Hero Section -->
    <header class="relative bg-gradient-to-r from-orange-600 to-red-600 text-white overflow-hidden">
        <div class="absolute inset-0 bg-black opacity-20"></div>
        <div class="absolute inset-0 bg-pattern"></div>
            
        <div class="relative container mx-auto px-4 py-16 text-center">
            <div class="mb-8">
                <!-- Logo Don Shawarma -->
                <div class="flex justify-center mb-6">
                    <img src="logo-don-shawarma.png" alt="Don Shawarma Logo" class="w-48 h-48 md:w-56 md:h-56 object-contain drop-shadow-2xl">
                </div>
        
                <h1 class="text-5xl md:text-7xl font-bold mb-4 drop-shadow-lg">Don Shawarma</h1>
                <div class="w-32 h-1 bg-yellow-400 mx-auto mb-6"></div>
            </div>

            <p class="text-xl md:text-2xl mb-8 max-w-2xl mx-auto font-light">
                Los mejores shawarmas de Santiago. Sabor aut√©ntico, ingredientes frescos, tradici√≥n en cada bocado.
            </p>
            
            <button onclick="openOrderFlow()" class="bg-yellow-400 text-orange-900 px-8 py-4 rounded-full text-xl font-bold hover:bg-yellow-300 transition-all transform hover:scale-105 shadow-2xl inline-flex items-center gap-2">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path>
                </svg>
                Armar mi Pedido
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
            </button>
        </div>
    </header>

    <!-- Order Flow Modal -->
    <div id="orderModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto">
        <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto fade-in">
            <!-- Modal Header -->
            <div class="bg-gradient-to-r from-orange-600 to-red-600 text-white p-6 rounded-t-2xl sticky top-0 z-10">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-2xl font-bold">Armar Pedido</h2>
                    <button onclick="closeOrderFlow()" class="hover:bg-white hover:bg-opacity-20 p-2 rounded-full transition">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                
                <!-- Progress Steps -->
                <div class="flex items-center justify-between text-sm" id="progressSteps">
                    <!-- Steps will be rendered by JS -->
                </div>
            </div>

            <!-- Step Content -->
            <div class="p-6" id="stepContent">
                <!-- Content will be rendered by JS -->
            </div>
        </div>
    </div>

    <!-- Location Modal -->
    <div id="locationModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl max-w-3xl w-full fade-in">
            <div class="p-6 border-b border-gray-200 flex justify-between items-center">
                <h3 class="text-2xl font-bold text-gray-800" id="locationTitle"></h3>
                <button onclick="closeLocationModal()" class="hover:bg-gray-100 p-2 rounded-full transition">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            
            <div class="p-6">
                <p class="text-gray-600 mb-4" id="locationAddress"></p>
                
                <div class="aspect-video w-full rounded-xl overflow-hidden mb-4">
                    <iframe id="locationMap" width="100%" height="100%" style="border:0" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                </div>
                
                <a id="locationDirections" href="#" target="_blank" class="block w-full bg-blue-600 text-white text-center py-3 rounded-full font-bold hover:bg-blue-700 transition">
                    Ver Ruta en Google Maps
                </a>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-16 space-y-16">
        <!-- Menu Section -->
        <section class="bg-white rounded-2xl shadow-xl p-8">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold text-gray-800 mb-2">Nuestro Men√∫</h2>
                <p class="text-gray-600">Descarga o visualiza nuestra carta completa</p>
            </div>
            
            <div class="flex justify-center">
                <a href="MENU  SHAWARMAS .pdf.pdf" target="_blank" class="bg-gradient-to-r from-orange-600 to-red-600 text-white px-8 py-4 rounded-full font-bold hover:shadow-lg transition-all transform hover:scale-105 inline-flex items-center gap-2">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                    Ver Men√∫ Completo (PDF)
                </a>
            </div>
        </section>

        <!-- WhatsApp Section -->
        <section class="bg-gradient-to-r from-green-600 to-green-500 rounded-2xl shadow-xl p-8 text-white">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold mb-2">Pide por WhatsApp</h2>
                <p class="text-green-100">Contacta directamente con la sede m√°s cercana</p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4" id="whatsappButtons">
                <!-- Buttons will be rendered by JS -->
            </div>
        </section>

        <!-- Locations Section -->
        <section class="bg-white rounded-2xl shadow-xl p-8">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold text-gray-800 mb-2">Nuestras Ubicaciones</h2>
                <p class="text-gray-600">Encu√©ntranos en Santiago</p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4" id="locationButtons">
                <!-- Buttons will be rendered by JS -->
            </div>
        </section>

        <!-- Social Section -->
        <section class="bg-gradient-to-r from-purple-600 to-pink-600 rounded-2xl shadow-xl p-8 text-white text-center">
            <h2 class="text-3xl font-bold mb-4">S√≠guenos en Instagram</h2>
            <p class="text-purple-100 mb-6">Mantente al d√≠a con nuestras promociones y novedades</p>
            
            <a href="https://www.instagram.com/donshawarmachile" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-2 bg-white text-purple-600 px-8 py-4 rounded-full font-bold hover:shadow-lg transition-all transform hover:scale-105">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                </svg>
                @donshawarmachile
            </a>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white py-8">
        <div class="container mx-auto px-4 text-center">
            <h2 class="text-2xl font-bold mb-2">Don Shawarma</h2>
            <p class="text-gray-400">La mejor comida √°rabe de Santiago</p>
            <p class="text-gray-500 text-sm mt-4">¬© 2025 Don Shawarma. Todos los derechos reservados.</p>
        </div>
    </footer>

    <script>
        // Data
        const locations = [
            {
                name: '√ëu√±oa',
                phone: '+56994123085',
                address: 'Av. Irarr√°zaval 1822, Nu√±oa',
                mapEmbed: 'https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3328.8514399644673!2d-70.61449702437184!3d-33.45317679765171!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x9662cf8e4d770fb1%3A0x29275fcf13f159d2!2sAv.%20Irarr%C3%A1zaval%201822%2C%207501173%20%C3%91u%C3%B1oa%2C%20Regi%C3%B3n%20Metropolitana!5e0!3m2!1ses!2scl!4v1771207894737!5m2!1ses!2scl'
            },
            {
                name: 'San Miguel',
                phone: '+56953118001',
                address: 'Berlin 1051, San Miguel',
                mapEmbed: 'https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3327.3309339810617!2d-70.65361332436996!3d-33.49276609968047!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x9662dacb8bfe4811%3A0x3574c7906b2c31a!2sBerl%C3%ADn%201051%2C%208900198%20San%20Miguel%2C%20Regi%C3%B3n%20Metropolitana!5e0!3m2!1ses!2scl!4v1771207856796!5m2!1ses!2scl'
            },
            {
                name: 'Puente Alto',
                phone: '+56979520540',
                address: 'Nemesio Vicu√±a 289, Puente Alto',
                mapEmbed: 'https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3322.864605382834!2d-70.57282902436435!3d-33.60881730564001!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x9662d65444e6c54f%3A0x6126bab38df30ebb!2sNemesio%20Vicu%C3%B1a%20289%2C%208150000%20Puente%20Alto%2C%20Regi%C3%B3n%20Metropolitana!5e0!3m2!1ses!2scl!4v1771207810659!5m2!1ses!2scl'
            },
            {
                name: 'La Cisterna',
                phone: '+56935627512',
                address: 'Uni√≥n 011, La Cisterna',
                mapEmbed: 'https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3325.441812614245!2d-70.66835582436757!3d-33.54189550220105!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x9662db7a85fb07cf%3A0xb3178996ac8ba504!2sShawarmas%20Chile%20La%20Cisterna!5e0!3m2!1ses!2scl!4v1771207737041!5m2!1ses!2scl'
            }
        ];

        const menuItems = {
            shawarmas: [
                { name: 'Shawarma Cl√°sico', price: 7490, description: 'Pan √°rabe con lechuga, tomate, salsa laban y prote√≠na a elecci√≥n', proteins: ['pollo', 'carne', 'mixto', 'falafel'] },
                { name: 'Shawarma Cl√°sico de Mechada', price: 7490, description: 'Pan √°rabe con lechuga, tomate, salsa laban y carne mechada', proteins: ['mechada'] },
                { name: 'Shawarma Vegetariano', price: 7490, description: 'Pan √°rabe con lechuga, tomate, crema de garbanzos y falafel', proteins: ['falafel'] },
                { name: 'Shawarma Italiano', price: 7990, description: 'Pan √°rabe con tomate, palta, salsa laban y prote√≠na a elecci√≥n', proteins: ['pollo', 'carne', 'mixto', 'falafel'] },
                { name: 'Shawarma Luco', price: 7990, description: 'Pan √°rabe con lechuga, tomate, queso, salsa laban y prote√≠na a elecci√≥n', proteins: ['pollo', 'carne', 'mixto', 'falafel'] },
                { name: 'Shawarma Champi√±√≥n Queso', price: 8990, description: 'Pan √°rabe con lechuga, tomate, champi√±√≥n, salsa laban y prote√≠na a elecci√≥n', proteins: ['pollo', 'carne', 'mixto', 'falafel'] },
                { name: 'Shawarma Premium', price: 8490, description: 'Pan √°rabe con crema hummus, lechuga, ensalada tabule, falafel, salsa laban y prote√≠na', proteins: ['carne', 'mixto', 'pollo', 'falafel'] },
                { name: 'Shawarma Premium Gold', price: 10990, description: 'Pan √°rabe con crema hummus, lechuga, ensalada tabule, falafel, kibbe, salsa laban y prote√≠na', proteins: ['carne', 'mixto', 'pollo', 'falafel'] }
            ],
            shawarmasGigantes: [
                { name: 'Shawarma Cl√°sico Gigante', price: 12990, description: 'Pan √°rabe con lechuga, tomate, salsa laban y prote√≠na a elecci√≥n', proteins: ['pollo', 'carne', 'mixto', 'falafel'] },
                { name: 'Shawarma Premium Gigante', price: 14490, description: 'Pan √°rabe con crema hummus, lechuga, ensalada tabule, falafel, salsa laban y prote√≠na', proteins: ['carne', 'mixto', 'pollo', 'falafel'] },
                { name: 'Shawarma Cl√°sico Gigante Mechada', price: 13990, description: 'Pan √°rabe con lechuga, tomate, salsa laban y carne mechada', proteins: ['mechada'] }
            ],
            hamburguesas: [
                { name: 'Hamburguesa Cl√°sica', price: 7990, description: 'Pan brioche, 150gr carne/pollo, queso cheddar, lechuga, tomate, cebolla morada, salsa laban y papas', proteins: ['carne', 'pollo'] },
                { name: 'Hamburguesa de Pollo Crispy', price: 7990, description: 'Pan brioche crispy, queso cheddar, lechuga, tomate, cebolla morada, salsa laban y papas' },
                { name: 'Hamburguesa Vegetariana', price: 7490, description: 'Pan brioche, falafel, lechuga, queso cheddar, tomate, cebolla morada, salsa laban y papas' },
                { name: 'Hamburguesa Italiana', price: 7990, description: 'Carne/pollo, tomate, palta, salsa laban y papas fritas', proteins: ['carne', 'pollo'] },
                { name: 'Hamburguesa Triple', price: 11490, description: '150gr carne, 150gr pollo, 150gr chuleta ahumada, queso, tomate, lechuga, cebolla, salsa y papas' },
                { name: 'Hamburguesa Don Shawarma #1', price: 9990, description: '150gr carne, queso cheddar, lechuga, tomate, cebolla morada, tocino, aros de cebolla, salsa y papas' },
                { name: 'Hamburguesa Don Shawarma #2', price: 9990, description: '150gr carne, queso cheddar, lechuga, tomate, cebolla morada, tocino, huevo frito, salsa y papas' },
                { name: 'Hamburguesa Doble Carne Vacuno', price: 9990, description: 'Pan brioche, doble carne vacuno, queso cheddar, lechuga, tomate, cebolla morada, salsa y papas' },
                { name: 'Hamburguesa Mixta', price: 9990, description: '150gr carne, 150gr pollo a la plancha, queso cheddar, tomate, cebolla morada, salsa y papas' }
            ],
            mechadas: [
                { name: 'Mechada Italiana', price: 7990, description: '150gr mechada con tomate en rodaja, palta, salsa laban y papas fritas' },
                { name: 'Mechada Luco', price: 7990, description: '150gr mechada y queso con tomate en rodajas, salsa laban y papas fritas' },
                { name: 'Mechada Champi√±√≥n', price: 7990, description: '150gr mechada y champi√±√≥n con tomate en rodajas, salsa laban y papas fritas' },
                { name: 'Mechada Cebolla Morada', price: 7990, description: '150gr mechada con tomate en rodajas, cebolla morada, salsa laban y papas fritas' }
            ],
            colaciones: [
                { name: 'Milanesa al Plato a lo Pobre', price: 7490, description: 'Milanesa de pollo, papas fritas y huevos' },
                { name: 'Milanesa al Plato de Pollo Apanada', price: 7490, description: 'Con ensalada de lechuga, tomate, palta, cebolla morada, choclo, papas fritas y arroz' },
                { name: 'Shawarma al Plato', price: 7490, description: 'Con ensalada de lechuga, tomate, palta, cebolla morada, choclo, papas fritas, arroz y prote√≠na', proteins: ['carne', 'pollo', 'mixto', 'falafel'] },
                { name: 'Mechada al Plato', price: 7490, description: 'Con ensalada de lechuga, tomate, palta, cebolla morada, choclo, arroz y papas fritas' }
            ],
            chorriwarmas: [
                { name: 'Chorriwarma Gigante', price: 14490, description: 'Base de papas fritas con carne salteada con ceboll√≠n, salsa laban y dos huevos fritos' },
                { name: 'Chorriwarma Individual', price: 7490, description: 'Base de papas fritas con carne salteada con ceboll√≠n, salsa laban y un huevo frito' }
            ],
            ensaladas: [
                { name: 'Ensalada C√©sar con Pollo', price: 7490, description: 'Deliciosa lechuga romana, tocino, pechuga de pollo a la plancha y queso parmesano' },
                { name: 'Ensalada Primavera', price: 7490, description: 'Lechuga romana, tomate en cuadros, choclo, pechuga de pollo a la plancha, queso gauda y parmesano' }
            ],
            promociones: [
                { name: 'Promo 1', price: 9990, description: 'Shawarma Cl√°sico + Papas + Bebida', proteins: ['pollo', 'carne', 'mixto', 'falafel'] },
                { name: 'Promo 2', price: 9990, description: 'Shawarma Cl√°sico + 3 Falafel + Bebida', proteins: ['pollo', 'carne', 'mixto', 'falafel'] },
                { name: 'Promo 3', price: 9990, description: 'Shawarma Cl√°sico + 6 Aros de Cebolla + Bebida', proteins: ['pollo', 'carne', 'mixto', 'falafel'] },
                { name: 'Promo 4', price: 9490, description: 'Hamburguesa Cl√°sica + Papas + Bebida' },
                { name: 'Promo 5', price: 9490, description: 'Mechada en Sandwich a Elecci√≥n + Papas + Bebida' },
                { name: 'Promo 6', price: 9490, description: 'Shawarma Premium + Bebida', proteins: ['carne', 'mixto', 'pollo', 'falafel'] },
                { name: 'Promo 7', price: 9990, description: 'Shawarma Mechada + Papas + Bebida' },
                { name: 'Promo ShawarmaFan', price: 12990, description: 'Shawarma Cl√°sico + 3 Falafel + 5 Hojas de Parra + Bebida', proteins: ['pollo', 'carne', 'mixto', 'falafel'] }
            ],
            promocionesCompartir: [
                { name: 'Promo Pareja', price: 20990, description: '2 Shawarma Cl√°sico + 5 Hojas de Parra + Papa Frita + 2 Bebidas' },
                { name: 'Promo para Picar', price: 13490, description: '5 Teque√±os + 5 Empanadas de Queso + 6 Aros de Cebolla + 6 Dedos de Mozzarella' },
                { name: 'Plato Mixto √Årabe', price: 12990, description: '4 hojas de parra, 4 falafel, porci√≥n de tabule, 2 kibbe y pan √°rabe' }
            ]
        };

        // State
        let currentStep = 1;
        let orderData = {
            sede: '',
            telefono: '',
            tipoEntrega: '',
            direccion: '',
            comuna: '',
            nombre: '',
            items: [],
            metodoPago: ''
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            renderWhatsAppButtons();
            renderLocationButtons();
        });

        function renderWhatsAppButtons() {
            const container = document.getElementById('whatsappButtons');
            container.innerHTML = locations.map(loc => `
                <a href="https://wa.me/${loc.phone.replace(/\+/g, '')}" target="_blank" rel="noopener noreferrer" class="bg-white text-gray-800 p-6 rounded-xl hover:shadow-lg transition-all transform hover:scale-105">
                    <svg class="w-8 h-8 text-green-600 mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                    </svg>
                    <h3 class="font-bold text-lg mb-1">${loc.name}</h3>
                    <p class="text-sm text-gray-600">${loc.phone}</p>
                </a>
            `).join('');
        }

        function renderLocationButtons() {
            const container = document.getElementById('locationButtons');
            container.innerHTML = locations.map((loc, index) => `
                <button onclick="openLocationModal(${index})" class="bg-gradient-to-br from-orange-50 to-red-50 p-6 rounded-xl hover:shadow-lg transition-all transform hover:scale-105 border-2 border-orange-200">
                    <svg class="w-8 h-8 text-orange-600 mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                    </svg>
                    <h3 class="font-bold text-lg mb-1">${loc.name}</h3>
                    <p class="text-sm text-gray-600">${loc.address}</p>
                </button>
            `).join('');
        }

        function openOrderFlow() {
            document.getElementById('orderModal').classList.remove('hidden');
            currentStep = 1;
            renderStep();
        }

        function closeOrderFlow() {
            document.getElementById('orderModal').classList.add('hidden');
            resetOrder();
        }

        function resetOrder() {
            currentStep = 1;
            orderData = {
                sede: '',
                telefono: '',
                tipoEntrega: '',
                direccion: '',
                comuna: '',
                nombre: '',
                items: [],
                metodoPago: ''
            };
        }

        function openLocationModal(index) {
            const loc = locations[index];
            document.getElementById('locationTitle').textContent = loc.name;
            document.getElementById('locationAddress').textContent = loc.address;
            document.getElementById('locationMap').src = loc.mapEmbed;
            document.getElementById('locationDirections').href = `https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(loc.address)}`;
            document.getElementById('locationModal').classList.remove('hidden');
        }

        function closeLocationModal() {
            document.getElementById('locationModal').classList.add('hidden');
        }

        function renderStep() {
            renderProgressSteps();
            
            const content = document.getElementById('stepContent');
            
            switch(currentStep) {
                case 1:
                    content.innerHTML = renderStep1();
                    break;
                case 2:
                    content.innerHTML = renderStep2();
                    break;
                case 3:
                    content.innerHTML = renderStep3();
                    break;
                case 4:
                    content.innerHTML = renderStep4();
                    break;
                case 5:
                    content.innerHTML = renderStep5();
                    break;
                case 6:
                    content.innerHTML = renderStep6();
                    break;
            }
        }

        function renderProgressSteps() {
            const container = document.getElementById('progressSteps');
            let html = '';
            for(let i = 1; i <= 6; i++) {
                const isActive = currentStep >= i;
                const isComplete = currentStep > i;
                html += `
                    <div class="flex items-center">
                        <div class="w-8 h-8 rounded-full flex items-center justify-center font-bold ${isActive ? 'bg-yellow-400 text-orange-900' : 'bg-white bg-opacity-30'}">
                            ${isComplete ? '‚úì' : i}
                        </div>
                        ${i < 6 ? `<div class="w-8 h-1 ${currentStep > i ? 'bg-yellow-400' : 'bg-white bg-opacity-30'}"></div>` : ''}
                    </div>
                `;
            }
            container.innerHTML = html;
        }

        function renderStep1() {
            return `
                <div>
                    <h3 class="text-2xl font-bold text-gray-800 mb-2">Selecciona tu Sede</h3>
                    <p class="text-gray-600 mb-6">¬øEn qu√© local quieres hacer tu pedido?</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        ${locations.map(loc => `
                            <button onclick="selectSede('${loc.name}', '${loc.phone}')" class="p-6 rounded-xl border-2 transition-all ${orderData.sede === loc.name ? 'border-orange-600 bg-orange-50 shadow-lg' : 'border-gray-200 hover:border-orange-300 hover:shadow'}">
                                <svg class="mb-2 ${orderData.sede === loc.name ? 'text-orange-600' : 'text-gray-400'} w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                </svg>
                                <h4 class="font-bold text-lg mb-1">${loc.name}</h4>
                                <p class="text-sm text-gray-600">${loc.address}</p>
                            </button>
                        `).join('')}
                    </div>
                    
                    <button onclick="nextStep()" ${!orderData.sede ? 'disabled' : ''} class="w-full mt-6 bg-orange-600 text-white py-3 rounded-full font-bold hover:bg-orange-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition">
                        Continuar ‚Üí
                    </button>
                </div>
            `;
        }

        function renderStep2() {
            return `
                <div>
                    <h3 class="text-2xl font-bold text-gray-800 mb-2">Tipo de Pedido</h3>
                    <p class="text-gray-600 mb-6">¬øRetiras en local o prefieres delivery?</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                        <button onclick="selectTipoEntrega('Retiro')" class="p-6 rounded-xl border-2 transition-all ${orderData.tipoEntrega === 'Retiro' ? 'border-orange-600 bg-orange-50 shadow-lg' : 'border-gray-200 hover:border-orange-300 hover:shadow'}">
                            <svg class="mb-2 ${orderData.tipoEntrega === 'Retiro' ? 'text-orange-600' : 'text-gray-400'} w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path>
                            </svg>
                            <h4 class="font-bold text-lg mb-1">Retiro en Local</h4>
                            <p class="text-sm text-gray-600">15-20 minutos</p>
                        </button>
                        
                        <button onclick="selectTipoEntrega('Delivery')" class="p-6 rounded-xl border-2 transition-all ${orderData.tipoEntrega === 'Delivery' ? 'border-orange-600 bg-orange-50 shadow-lg' : 'border-gray-200 hover:border-orange-300 hover:shadow'}">
                            <svg class="mb-2 ${orderData.tipoEntrega === 'Delivery' ? 'text-orange-600' : 'text-gray-400'} w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            <h4 class="font-bold text-lg mb-1">Delivery</h4>
                            <p class="text-sm text-gray-600">30-60 minutos</p>
                        </button>
                    </div>
                    
                    ${orderData.tipoEntrega === 'Delivery' ? `
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Direcci√≥n</label>
                                <input type="text" id="direccion" value="${orderData.direccion}" oninput="updateDireccionReal(this.value)" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-600 focus:border-transparent" placeholder="Calle 123, Depto 45">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Comuna</label>
                                <input type="text" id="comuna" value="${orderData.comuna}" oninput="updateComunaReal(this.value)" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-600 focus:border-transparent" placeholder="Comuna">
                            </div>
                        </div>
                    ` : ''}
                    
                    <div class="flex gap-4 mt-6">
                        <button onclick="prevStep()" class="flex-1 bg-gray-200 text-gray-700 py-3 rounded-full font-bold hover:bg-gray-300 transition">
                            ‚Üê Atr√°s
                        </button>
                        <button onclick="nextStep()" ${!canProceedStep2() ? 'disabled' : ''} class="flex-1 bg-orange-600 text-white py-3 rounded-full font-bold hover:bg-orange-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition">
                            Continuar ‚Üí
                        </button>
                    </div>
                </div>
            `;
        }

        function renderStep3() {
            return `
                <div>
                    <h3 class="text-2xl font-bold text-gray-800 mb-2">Tus Datos</h3>
                    <p class="text-gray-600 mb-6">¬øA nombre de qui√©n va el pedido?</p>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Nombre y Apellido</label>
                        <input type="text" id="nombre" value="${orderData.nombre}" oninput="updateNombreReal(this.value)" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-600 focus:border-transparent" placeholder="Juan P√©rez">
                    </div>
                    
                    <div class="flex gap-4 mt-6">
                        <button onclick="prevStep()" class="flex-1 bg-gray-200 text-gray-700 py-3 rounded-full font-bold hover:bg-gray-300 transition">
                            ‚Üê Atr√°s
                        </button>
                        <button id="btnContinuarNombre" onclick="nextStep()" ${!orderData.nombre ? 'disabled' : ''} class="flex-1 bg-orange-600 text-white py-3 rounded-full font-bold hover:bg-orange-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition">
                            Continuar ‚Üí
                        </button>
                    </div>
                </div>
            `;
        }
        
        function updateNombreReal(value) {
            orderData.nombre = value.trim();
            const btn = document.getElementById('btnContinuarNombre');
            if (btn) {
                if (orderData.nombre) {
                    btn.disabled = false;
                    btn.classList.remove('bg-gray-300', 'cursor-not-allowed');
                    btn.classList.add('bg-orange-600');
                } else {
                    btn.disabled = true;
                    btn.classList.add('bg-gray-300', 'cursor-not-allowed');
                    btn.classList.remove('bg-orange-600');
                }
            }
        }
        
        function updateDireccionReal(value) {
            orderData.direccion = value.trim();
            updateStep2Button();
        }
        
        function updateComunaReal(value) {
            orderData.comuna = value.trim();
            updateStep2Button();
        }
        
        function updateStep2Button() {
            const buttons = document.querySelectorAll('#stepContent button[onclick="nextStep()"]');
            if (buttons.length > 0) {
                const btn = buttons[0];
                const canProceed = orderData.tipoEntrega && 
                    (orderData.tipoEntrega === 'Retiro' || 
                    (orderData.direccion && orderData.comuna));
                
                if (canProceed) {
                    btn.disabled = false;
                    btn.classList.remove('bg-gray-300', 'cursor-not-allowed');
                    btn.classList.add('bg-orange-600');
                } else {
                    btn.disabled = true;
                    btn.classList.add('bg-gray-300', 'cursor-not-allowed');
                    btn.classList.remove('bg-orange-600');
                }
            }
        }

        function renderStep4() {
            const total = calculateTotal();
            return `
                <div class="flex flex-col h-full">
                    <h3 class="text-2xl font-bold text-gray-800 mb-2">Arma tu Pedido</h3>
                    <p class="text-gray-600 mb-4">Selecciona los productos que deseas</p>
                    
                    <!-- Menu de productos (con scroll) -->
                    <div class="flex-1 space-y-4 overflow-y-auto pr-2 mb-4" style="min-height: 300px;">
                        ${renderMenuCategories()}
                    </div>
                    
                    <!-- Carrito en la parte INFERIOR -->
                    ${orderData.items.length > 0 ? `
                        <div class="bg-orange-50 rounded-xl p-4 mb-4 border-2 border-orange-200">
                            <h4 class="font-bold text-lg mb-3 flex items-center gap-2">
                                <svg class="w-5 h-5 text-orange-600" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M5 4h1.5L9 16h10l4-14H7.12M9 13h10M16 19.5h2m-8 0h2"></path>
                                </svg>
                                Tu Carrito (${orderData.items.length} item${orderData.items.length > 1 ? 's' : ''})
                            </h4>
                            <div class="space-y-2 max-h-48 overflow-y-auto pr-2">
                                ${orderData.items.map((item, index) => `
                                    <div class="bg-white rounded-lg p-3 flex items-center justify-between gap-2">
                                        <div class="flex-1 min-w-0">
                                            <p class="font-bold text-sm truncate">${item.name}</p>
                                            ${item.protein ? `<p class="text-xs text-gray-600">${item.protein}</p>` : ''}
                                            ${item.notes ? `<p class="text-xs text-gray-500 italic">Obs: ${item.notes}</p>` : ''}
                                        </div>
                                        <div class="flex items-center gap-2 flex-shrink-0">
                                            <button onclick="removeItem(${index})" class="w-6 h-6 bg-red-100 text-red-600 rounded hover:bg-red-200 font-bold flex items-center justify-center text-sm">-</button>
                                            <button onclick="duplicateItem(${index})" class="w-6 h-6 bg-orange-100 text-orange-600 rounded hover:bg-orange-200 font-bold flex items-center justify-center text-sm">+</button>
                                            <span class="font-bold text-sm ml-2 w-12 text-right">$${item.price.toLocaleString('es-CL')}</span>
                                            <button onclick="removeItem(${index})" class="text-red-600 hover:text-red-700">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                            
                            <div class="mt-3 pt-3 border-t border-orange-300">
                                <div class="flex justify-between items-center font-bold text-lg">
                                    <span>Total:</span>
                                    <span class="text-orange-600">$${total.toLocaleString('es-CL')}</span>
                                </div>
                            </div>
                        </div>
                    ` : `
                        <div class="bg-blue-50 rounded-xl p-4 mb-4 border-2 border-blue-200">
                            <p class="text-blue-700 text-sm">‚ÑπÔ∏è Tu carrito est√° vac√≠o. Selecciona productos para comenzar.</p>
                        </div>
                    `}
                    
                    <div class="flex gap-4">
                        <button onclick="prevStep()" class="flex-1 bg-gray-200 text-gray-700 py-3 rounded-full font-bold hover:bg-gray-300 transition">
                            ‚Üê Atr√°s
                        </button>
                        <button onclick="nextStep()" ${orderData.items.length === 0 ? 'disabled' : ''} class="flex-1 bg-orange-600 text-white py-3 rounded-full font-bold hover:bg-orange-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition">
                            Confirmar y Continuar ‚Üí
                        </button>
                    </div>
                </div>
            `;
        }

        function renderMenuCategories() {
            let html = '';
            
            // Shawarmas
            html += `
                <div class="mb-6">
                    <h4 class="font-bold text-lg mb-3 text-orange-600">ü•ô Shawarmas</h4>
                    <div class="overflow-x-auto pb-2 -mx-6 px-6" style="scroll-behavior: smooth;">
                        <div class="flex gap-3 min-w-max">
                            ${menuItems.shawarmas.map((item, idx) => `
                                <button onclick='addItem(${JSON.stringify(item)})' class="flex-shrink-0 w-64 text-left p-4 bg-white rounded-lg border border-gray-200 hover:border-orange-600 hover:shadow transition">
                                    <div class="flex justify-between items-start gap-2 mb-2">
                                        <span class="font-bold text-sm flex-1">${item.name}</span>
                                        <span class="font-bold text-orange-600 whitespace-nowrap">$${item.price.toLocaleString('es-CL')}</span>
                                    </div>
                                    <p class="text-xs text-gray-600 line-clamp-3">${item.description}</p>
                                </button>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
            
            // Shawarmas Gigantes
            html += `
                <div class="mb-6">
                    <h4 class="font-bold text-lg mb-3 text-orange-600">ü•ô Shawarmas Gigantes</h4>
                    <div class="overflow-x-auto pb-2 -mx-6 px-6" style="scroll-behavior: smooth;">
                        <div class="flex gap-3 min-w-max">
                            ${menuItems.shawarmasGigantes.map((item, idx) => `
                                <button onclick='addItem(${JSON.stringify(item)})' class="flex-shrink-0 w-64 text-left p-4 bg-white rounded-lg border border-gray-200 hover:border-orange-600 hover:shadow transition">
                                    <div class="flex justify-between items-start gap-2 mb-2">
                                        <span class="font-bold text-sm flex-1">${item.name}</span>
                                        <span class="font-bold text-orange-600 whitespace-nowrap">$${item.price.toLocaleString('es-CL')}</span>
                                    </div>
                                    <p class="text-xs text-gray-600 line-clamp-3">${item.description}</p>
                                </button>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
            
            // Hamburguesas
            html += `
                <div class="mb-6">
                    <h4 class="font-bold text-lg mb-3 text-orange-600">üçî Hamburguesas</h4>
                    <div class="overflow-x-auto pb-2 -mx-6 px-6" style="scroll-behavior: smooth;">
                        <div class="flex gap-3 min-w-max">
                            ${menuItems.hamburguesas.map((item, idx) => `
                                <button onclick='addItem(${JSON.stringify(item)})' class="flex-shrink-0 w-64 text-left p-4 bg-white rounded-lg border border-gray-200 hover:border-orange-600 hover:shadow transition">
                                    <div class="flex justify-between items-start gap-2 mb-2">
                                        <span class="font-bold text-sm flex-1">${item.name}</span>
                                        <span class="font-bold text-orange-600 whitespace-nowrap">$${item.price.toLocaleString('es-CL')}</span>
                                    </div>
                                    <p class="text-xs text-gray-600 line-clamp-3">${item.description}</p>
                                </button>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
            
            // Mechadas
            html += `
                <div class="mb-6">
                    <h4 class="font-bold text-lg mb-3 text-orange-600">ü•™ Mechadas</h4>
                    <div class="overflow-x-auto pb-2 -mx-6 px-6" style="scroll-behavior: smooth;">
                        <div class="flex gap-3 min-w-max">
                            ${menuItems.mechadas.map((item, idx) => `
                                <button onclick='addItem(${JSON.stringify(item)})' class="flex-shrink-0 w-64 text-left p-4 bg-white rounded-lg border border-gray-200 hover:border-orange-600 hover:shadow transition">
                                    <div class="flex justify-between items-start gap-2 mb-2">
                                        <span class="font-bold text-sm flex-1">${item.name}</span>
                                        <span class="font-bold text-orange-600 whitespace-nowrap">$${item.price.toLocaleString('es-CL')}</span>
                                    </div>
                                    <p class="text-xs text-gray-600 line-clamp-3">${item.description}</p>
                                </button>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
            
            // Colaciones
            html += `
                <div class="mb-6">
                    <h4 class="font-bold text-lg mb-3 text-orange-600">üçΩÔ∏è Colaciones</h4>
                    <div class="overflow-x-auto pb-2 -mx-6 px-6" style="scroll-behavior: smooth;">
                        <div class="flex gap-3 min-w-max">
                            ${menuItems.colaciones.map((item, idx) => `
                                <button onclick='addItem(${JSON.stringify(item)})' class="flex-shrink-0 w-64 text-left p-4 bg-white rounded-lg border border-gray-200 hover:border-orange-600 hover:shadow transition">
                                    <div class="flex justify-between items-start gap-2 mb-2">
                                        <span class="font-bold text-sm flex-1">${item.name}</span>
                                        <span class="font-bold text-orange-600 whitespace-nowrap">$${item.price.toLocaleString('es-CL')}</span>
                                    </div>
                                    <p class="text-xs text-gray-600 line-clamp-3">${item.description}</p>
                                </button>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
            
            // Chorriwarmas
            html += `
                <div class="mb-6">
                    <h4 class="font-bold text-lg mb-3 text-orange-600">üå≠ Chorriwarmas</h4>
                    <div class="overflow-x-auto pb-2 -mx-6 px-6" style="scroll-behavior: smooth;">
                        <div class="flex gap-3 min-w-max">
                            ${menuItems.chorriwarmas.map((item, idx) => `
                                <button onclick='addItem(${JSON.stringify(item)})' class="flex-shrink-0 w-64 text-left p-4 bg-white rounded-lg border border-gray-200 hover:border-orange-600 hover:shadow transition">
                                    <div class="flex justify-between items-start gap-2 mb-2">
                                        <span class="font-bold text-sm flex-1">${item.name}</span>
                                        <span class="font-bold text-orange-600 whitespace-nowrap">$${item.price.toLocaleString('es-CL')}</span>
                                    </div>
                                    <p class="text-xs text-gray-600 line-clamp-3">${item.description}</p>
                                </button>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
            
            // Ensaladas
            html += `
                <div class="mb-6">
                    <h4 class="font-bold text-lg mb-3 text-orange-600">ü•ó Ensaladas</h4>
                    <div class="overflow-x-auto pb-2 -mx-6 px-6" style="scroll-behavior: smooth;">
                        <div class="flex gap-3 min-w-max">
                            ${menuItems.ensaladas.map((item, idx) => `
                                <button onclick='addItem(${JSON.stringify(item)})' class="flex-shrink-0 w-64 text-left p-4 bg-white rounded-lg border border-gray-200 hover:border-orange-600 hover:shadow transition">
                                    <div class="flex justify-between items-start gap-2 mb-2">
                                        <span class="font-bold text-sm flex-1">${item.name}</span>
                                        <span class="font-bold text-orange-600 whitespace-nowrap">$${item.price.toLocaleString('es-CL')}</span>
                                    </div>
                                    <p class="text-xs text-gray-600 line-clamp-3">${item.description}</p>
                                </button>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
            
            // Promociones
            html += `
                <div class="mb-6">
                    <h4 class="font-bold text-lg mb-3 text-green-600">üéâ Promociones</h4>
                    <div class="overflow-x-auto pb-2 -mx-6 px-6" style="scroll-behavior: smooth;">
                        <div class="flex gap-3 min-w-max">
                            ${menuItems.promociones.map((item, idx) => `
                                <button onclick='addItem(${JSON.stringify(item)})' class="flex-shrink-0 w-64 text-left p-4 bg-green-50 rounded-lg border border-green-200 hover:border-green-600 hover:shadow transition">
                                    <div class="flex justify-between items-start gap-2 mb-2">
                                        <span class="font-bold text-sm flex-1">${item.name}</span>
                                        <span class="font-bold text-green-600 whitespace-nowrap">$${item.price.toLocaleString('es-CL')}</span>
                                    </div>
                                    <p class="text-xs text-gray-600 line-clamp-3">${item.description}</p>
                                </button>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
            
            // Promociones para Compartir
            html += `
                <div class="mb-6">
                    <h4 class="font-bold text-lg mb-3 text-purple-600">üë• Promociones para Compartir</h4>
                    <div class="overflow-x-auto pb-2 -mx-6 px-6" style="scroll-behavior: smooth;">
                        <div class="flex gap-3 min-w-max">
                            ${menuItems.promocionesCompartir.map((item, idx) => `
                                <button onclick='addItem(${JSON.stringify(item)})' class="flex-shrink-0 w-64 text-left p-4 bg-purple-50 rounded-lg border border-purple-200 hover:border-purple-600 hover:shadow transition">
                                    <div class="flex justify-between items-start gap-2 mb-2">
                                        <span class="font-bold text-sm flex-1">${item.name}</span>
                                        <span class="font-bold text-purple-600 whitespace-nowrap">$${item.price.toLocaleString('es-CL')}</span>
                                    </div>
                                    <p class="text-xs text-gray-600 line-clamp-3">${item.description}</p>
                                </button>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
            
            return html;
        }

        function renderStep5() {
            return `
                <div>
                    <h3 class="text-2xl font-bold text-gray-800 mb-2">M√©todo de Pago</h3>
                    <p class="text-gray-600 mb-6">¬øC√≥mo vas a pagar?</p>
                    
                    <div class="grid grid-cols-1 gap-4">
                        ${['Efectivo', 'D√©bito', 'Transferencia'].map(metodo => `
                            <button onclick="selectMetodoPago('${metodo}')" class="p-4 rounded-xl border-2 transition-all text-left ${orderData.metodoPago === metodo ? 'border-orange-600 bg-orange-50 shadow-lg' : 'border-gray-200 hover:border-orange-300 hover:shadow'}">
                                <h4 class="font-bold text-lg">${metodo}</h4>
                            </button>
                        `).join('')}
                    </div>
                    
                    <div class="flex gap-4 mt-6">
                        <button onclick="prevStep()" class="flex-1 bg-gray-200 text-gray-700 py-3 rounded-full font-bold hover:bg-gray-300 transition">
                            ‚Üê Atr√°s
                        </button>
                        <button onclick="nextStep()" ${!orderData.metodoPago ? 'disabled' : ''} class="flex-1 bg-orange-600 text-white py-3 rounded-full font-bold hover:bg-orange-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition">
                            Continuar ‚Üí
                        </button>
                    </div>
                </div>
            `;
        }

        function renderStep6() {
            const total = calculateTotal();
            return `
                <div>
                    <div class="text-center mb-6">
                        <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                        </div>
                        <h3 class="text-2xl font-bold text-gray-800 mb-2">¬°Pedido Listo!</h3>
                        <p class="text-gray-600">Revisa tu pedido antes de enviarlo</p>
                    </div>
                    
                    <div class="bg-gray-50 rounded-xl p-6 mb-6 space-y-4">
                        <div>
                            <p class="text-sm text-gray-600">Sede</p>
                            <p class="font-bold">${orderData.sede}</p>
                        </div>
                        
                        <div>
                            <p class="text-sm text-gray-600">Tipo de entrega</p>
                            <p class="font-bold">${orderData.tipoEntrega}</p>
                            ${orderData.tipoEntrega === 'Delivery' ? `<p class="text-sm">${orderData.direccion}, ${orderData.comuna}</p>` : ''}
                        </div>
                        
                        <div>
                            <p class="text-sm text-gray-600">Cliente</p>
                            <p class="font-bold">${orderData.nombre}</p>
                        </div>
                        
                        <div>
                            <p class="text-sm text-gray-600">M√©todo de pago</p>
                            <p class="font-bold">${orderData.metodoPago}</p>
                        </div>
                        
                        <div>
                            <p class="text-sm text-gray-600 mb-2">Productos</p>
                            ${orderData.items.map(item => `
                                <div class="flex justify-between text-sm mb-1">
                                    <span>1x ${item.name} ${item.protein ? `(${item.protein})` : ''}</span>
                                    <span class="font-bold">$${item.price.toLocaleString('es-CL')}</span>
                                </div>
                            `).join('')}
                        </div>
                        
                        <div class="pt-4 border-t border-gray-300">
                            <div class="flex justify-between items-center text-xl font-bold">
                                <span>Total:</span>
                                <span class="text-orange-600">$${total.toLocaleString('es-CL')}</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-blue-50 rounded-xl p-4 mb-6 flex items-center gap-3">
                        <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <div>
                            <p class="font-bold text-blue-900">Tiempo estimado</p>
                            <p class="text-sm text-blue-700">${orderData.tipoEntrega === 'Delivery' ? '30-60 minutos' : '15-20 minutos'}</p>
                        </div>
                    </div>
                    
                    <div class="flex gap-4">
                        <button onclick="prevStep()" class="flex-1 bg-gray-200 text-gray-700 py-3 rounded-full font-bold hover:bg-gray-300 transition">
                            ‚Üê Atr√°s
                        </button>
                        <button onclick="sendToWhatsApp()" class="flex-1 bg-green-600 text-white py-3 rounded-full font-bold hover:bg-green-700 transition flex items-center justify-center gap-2">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                            </svg>
                            Enviar al WhatsApp
                        </button>
                    </div>
                </div>
            `;
        }

        // Helper functions
        function selectSede(name, phone) {
            orderData.sede = name;
            orderData.telefono = phone;
            renderStep();
        }

        function selectTipoEntrega(tipo) {
            orderData.tipoEntrega = tipo;
            if (tipo === 'Retiro') {
                orderData.direccion = '';
                orderData.comuna = '';
            }
            renderStep();
        }

        function updateDireccion(value) {
            orderData.direccion = value;
        }

        function updateComuna(value) {
            orderData.comuna = value;
        }

        function updateNombre(value) {
            orderData.nombre = value;
        }

        function canProceedStep2() {
            if (!orderData.tipoEntrega) return false;
            if (orderData.tipoEntrega === 'Delivery' && (!orderData.direccion || !orderData.comuna)) return false;
            return true;
        }

        let currentItemForProtein = null;
        
        function addItem(item) {
            if (item.proteins && item.proteins.length > 0) {
                currentItemForProtein = item;
                showProteinModal(item);
            } else {
                const newItem = {
                    ...item,
                    notes: '',
                    protein: null
                };
                orderData.items.push(newItem);
                showAddedNotification(item.name, null);
                renderStep();
            }
        }
        
        function showProteinModal(item) {
            const proteins = item.proteins;
            let modalHtml = `
                <div id="proteinModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
                    <div class="bg-white rounded-2xl shadow-2xl max-w-sm w-full">
                        <div class="bg-gradient-to-r from-orange-600 to-red-600 text-white p-6 rounded-t-2xl">
                            <h3 class="text-xl font-bold">${item.name}</h3>
                            <p class="text-sm text-orange-100">$${item.price.toLocaleString('es-CL')}</p>
                            <p class="text-xs text-orange-200 mt-2">${item.description}</p>
                        </div>
                        <div class="p-6">
                            <p class="text-sm font-bold text-gray-700 mb-3">Selecciona la prote√≠na:</p>
                            <div class="space-y-2 mb-4">
            `;
            
            proteins.forEach((protein, idx) => {
                modalHtml += `
                    <button onclick="selectProteinAndAddToCart('${protein.charAt(0).toUpperCase() + protein.slice(1)}', '${protein}')" class="w-full text-left p-3 rounded-lg border-2 border-gray-200 hover:border-orange-600 hover:bg-orange-50 transition font-medium text-gray-800">
                        ${protein.charAt(0).toUpperCase() + protein.slice(1)}
                    </button>
                `;
            });
            
            modalHtml += `
                            </div>
                        </div>
                        <div class="p-6 border-t border-gray-200 flex gap-2">
                            <button onclick="closeProteinModal()" class="flex-1 bg-gray-200 text-gray-700 py-2 rounded-full font-bold hover:bg-gray-300 transition text-sm">
                                Cancelar
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            const modal = document.createElement('div');
            modal.innerHTML = modalHtml;
            document.body.appendChild(modal);
        }
        
        function selectProteinAndAddToCart(displayName, protein) {
            if (currentItemForProtein) {
                const newItem = {
                    ...currentItemForProtein,
                    notes: '',
                    protein: displayName
                };
                orderData.items.push(newItem);
                
                // Mostrar confirmaci√≥n
                showAddedNotification(currentItemForProtein.name, displayName);
                
                currentItemForProtein = null;
                closeProteinModal();
                renderStep();
            }
        }
        
        function showAddedNotification(productName, protein) {
            const notification = document.createElement('div');
            notification.className = 'fixed bottom-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-pulse';
            if (protein) {
                notification.textContent = `‚úì ${productName} (${protein}) a√±adido al carrito`;
            } else {
                notification.textContent = `‚úì ${productName} a√±adido al carrito`;
            }
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 2000);
        }
        
        function confirmProteinAddItem(protein) {
            if (currentItemForProtein) {
                const newItem = {
                    ...currentItemForProtein,
                    notes: '',
                    protein: protein
                };
                orderData.items.push(newItem);
                currentItemForProtein = null;
                closeProteinModal();
                renderStep();
            }
        }
        
        function closeProteinModal() {
            const modal = document.getElementById('proteinModal');
            if (modal) {
                modal.parentElement.removeChild(modal);
            }
        }
        
        function duplicateItem(index) {
            const item = orderData.items[index];
            const newItem = {
                ...item,
                notes: ''
            };
            orderData.items.splice(index + 1, 0, newItem);
            renderStep();
        }

        function removeItem(index) {
            orderData.items.splice(index, 1);
            renderStep();
        }

        function updateNotes(index, notes) {
            orderData.items[index].notes = notes;
        }

        function selectMetodoPago(metodo) {
            orderData.metodoPago = metodo;
            renderStep();
        }

        function calculateTotal() {
            return orderData.items.reduce((sum, item) => sum + item.price, 0);
        }

        function nextStep() {
            if (currentStep < 6) {
                currentStep++;
                renderStep();
            }
        }

        function prevStep() {
            if (currentStep > 1) {
                currentStep--;
                renderStep();
            }
        }

        function sendToWhatsApp() {
            let message = `ü•ô *NUEVO PEDIDO - DON SHAWARMA*\n\n`;
            message += `üë§ *Cliente:* ${orderData.nombre}\n`;
            message += `üìç *Sede:* ${orderData.sede}\n`;
            message += `üì¶ *Tipo:* ${orderData.tipoEntrega}\n`;
            
            if (orderData.tipoEntrega === 'Delivery') {
                message += `üè† *Direcci√≥n:* ${orderData.direccion}, ${orderData.comuna}\n`;
            }
            
            message += `\nüõí *PEDIDO:*\n`;
            let total = 0;
            orderData.items.forEach((item, index) => {
                message += `\n${index + 1}. ${item.name}\n`;
                if (item.protein) message += `   Prote√≠na: ${item.protein}\n`;
                if (item.notes) message += `   Obs: ${item.notes}\n`;
                message += `   Precio: $${item.price.toLocaleString('es-CL')}\n`;
                total += item.price;
            });
            
            message += `\nüí∞ *TOTAL: $${total.toLocaleString('es-CL')}*\n`;
            message += `üí≥ *M√©todo de pago:* ${orderData.metodoPago}\n`;
            
            const timeEstimate = orderData.tipoEntrega === 'Delivery' ? '30-60 minutos' : '15-20 minutos';
            message += `\n‚è±Ô∏è Tiempo estimado: ${timeEstimate}`;
            
            const encodedMessage = encodeURIComponent(message);
            const phone = orderData.telefono.replace(/\+/g, '');
            window.open(`https://wa.me/${phone}?text=${encodedMessage}`, '_blank');
            closeOrderFlow();
        }
    </script>
</body>
</html>
